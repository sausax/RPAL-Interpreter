let
.function_form
..<ID:Innerproduct>
..<ID:S1>
..<ID:S2>
..where
...->
....not
.....&
......gamma
.......<ID:Istuple>
.......<ID:S1>
......gamma
.......<ID:Istuple>
.......<ID:S2>
....<STR:'Args not both tuples'>
....->
.....ne
......gamma
.......<ID:Order>
.......<ID:S1>
......gamma
.......<ID:Order>
.......<ID:S2>
.....<STR:'Args of unequal length'>
.....gamma
......gamma
.......gamma
........<ID:Partial_sum>
........<ID:S1>
.......<ID:S2>
......gamma
.......<ID:Order>
.......<ID:S1>
...rec
....function_form
.....<ID:Partial_sum>
.....<ID:A>
.....<ID:B>
.....<ID:N>
.....->
......eq
.......<ID:N>
.......<INT:0>
......<INT:0>
......+
.......*
........gamma
.........<ID:A>
.........<ID:N>
........gamma
.........<ID:B>
.........<ID:N>
.......gamma
........gamma
.........gamma
..........<ID:Partial_sum>
..........<ID:A>
.........<ID:B>
........-
.........<ID:N>
.........<INT:1>
.gamma
..<ID:Print>
..tau
...gamma
....gamma
.....<ID:Innerproduct>
.....<nil>
....<nil>
...gamma
....gamma
.....<ID:Innerproduct>
.....tau
......<INT:1>
......<INT:2>
......<INT:3>
....tau
.....<INT:4>
.....<INT:5>
.....<INT:6>
...gamma
....gamma
.....<ID:Innerproduct>
.....tau
......<INT:1>
......<INT:2>
....tau
.....<INT:3>
.....<INT:4>
.....<INT:5>
...gamma
....gamma
.....<ID:Innerproduct>
.....<INT:1>
....tau
.....<INT:2>
.....<INT:3>
.....<INT:4>
